---
import { getCollection } from "astro:content";

import BaseLayout from "../layouts/BaseLayout.astro";
import BlogList from "../components/BlogList";
import Bio from "../components/bio";
import Footer from "../components/Footer";

const allBlogPosts = await getCollection("blog");

const posts = allBlogPosts
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .map((post) => ({
    slug: `blog/${post.slug}`,
    title: post.data.title,
    description: post.data.description ?? /* WIP */ post.body.slice(0, 100),
    date: post.data.date,
    category: post.data.category,
  }));
---

<BaseLayout>
  <section class="bio-section">
    <Bio />
  </section>
  <section class="list-section">
    <BlogList posts={posts} />
  </section>
  <Footer />
</BaseLayout>

<style lang="scss">
  @use "../styles/mixins.scss";

  .bio-section {
    @include mixins.container;
  }

  .list-section {
    @include mixins.container;
  }
</style>
